import{$ as U,aw as k,A as S,a2 as x,az as G,v as o,I as d,aR as P,h as B,c0 as z,a_ as H,cH as K,cI as V}from"./index.47b6fe0f.js";const j=""+new URL("resume.6e209205.svg",import.meta.url).href,q=""+new URL("p-rotate.1d232189.svg",import.meta.url).href,J=""+new URL("scale.8d8ebde4.svg",import.meta.url).href,Q=""+new URL("unscale.99ad049c.svg",import.meta.url).href,Z=""+new URL("unrotate.f9dd5a27.svg",import.meta.url).href;var c;(function(n){n[n.LOADING=0]="LOADING",n[n.DONE=1]="DONE",n[n.FAIL=2]="FAIL"})(c||(c={}));const ee={show:{type:Boolean,default:!1},imageList:{type:[Array],default:null},index:{type:Number,default:0},scaleStep:{type:Number},defaultWidth:{type:Number},maskClosable:{type:Boolean},rememberState:{type:Boolean}},i="img-preview",ne=U({name:"ImagePreview",props:ee,emits:["img-load","img-error"],setup(n,{expose:g,emit:I}){const r=new Map,t=k({currentUrl:"",imgScale:1,imgRotate:0,imgTop:0,imgLeft:0,status:c.LOADING,currentIndex:0,moveX:0,moveY:0,show:n.show}),f=S(null),u=S(null);function _(){M();const{index:e,imageList:l}=n;if(!l||!l.length)throw new Error("imageList is undefined");t.currentIndex=e,$(l[e])}function w(){t.imgScale=1,t.imgRotate=0,t.imgTop=0,t.imgLeft=0}function M(){const e=d(f);!e||(e.onmousewheel=L,document.body.addEventListener("DOMMouseScroll",L),document.ondragstart=function(){return!1})}const v=x(()=>{var l;const e=(l=n==null?void 0:n.scaleStep)!=null?l:0;return(e!=null?e:0>0)?e/100:t.imgScale/10});function L(e){e=e||window.event,e.delta=e.wheelDelta||-e.detail,e.preventDefault(),e.delta>0&&h(v.value),e.delta<0&&h(-v.value)}function h(e){t.imgScale<=.2&&e<0||(t.imgScale+=e)}function p(e){t.imgRotate+=e}function A(){const e=d(u);!e||(e.onmousemove=null)}function $(e){t.status=c.LOADING;const l=new Image;l.src=e,l.onload=a=>{if(t.currentUrl!==e){const s=a.composedPath();if(n.rememberState){r.set(t.currentUrl,{scale:t.imgScale,top:t.imgTop,left:t.imgLeft,rotate:t.imgRotate});const m=r.get(e);m?(t.imgScale=m.scale,t.imgTop=m.top,t.imgRotate=m.rotate,t.imgLeft=m.left):(w(),n.defaultWidth&&(t.imgScale=n.defaultWidth/s[0].naturalWidth))}else n.defaultWidth&&(t.imgScale=n.defaultWidth/s[0].naturalWidth);s&&I("img-load",{index:t.currentIndex,dom:s[0],url:e})}t.currentUrl=e,t.status=c.DONE},l.onerror=a=>{const s=a.composedPath();s&&I("img-error",{index:t.currentIndex,dom:s[0],url:e}),t.status=c.FAIL}}function b(e){e&&e.stopPropagation(),C()}function C(){t.show=!1,document.body.removeEventListener("DOMMouseScroll",L),document.ondragstart=null}function R(){w()}g({resume:R,close:C,prev:y.bind(null,"left"),next:y.bind(null,"right"),setScale:e=>{e>0&&e<=10&&(t.imgScale=e)},setRotate:e=>{t.imgRotate=e}});function y(e){const{currentIndex:l}=t,{imageList:a}=n;e==="left"&&(t.currentIndex--,l<=0&&(t.currentIndex=a.length-1)),e==="right"&&(t.currentIndex++,l>=a.length-1&&(t.currentIndex=0)),$(a[t.currentIndex])}function N(e){e=e||window.event,t.moveX=e.clientX,t.moveY=e.clientY;const l=d(u);l&&(l.onmousemove=W)}function W(e){e=e||window.event,e.preventDefault();const l=e.clientX-t.moveX,a=e.clientY-t.moveY;t.imgLeft+=l,t.imgTop+=a,t.moveX=e.clientX,t.moveY=e.clientY}const Y=x(()=>{const{imgScale:e,imgRotate:l,imgTop:a,imgLeft:s}=t;return{transform:`scale(${e}) rotate(${l}deg)`,marginTop:`${a}px`,marginLeft:`${s}px`,maxWidth:n.defaultWidth?"unset":"100%"}}),D=x(()=>{const{imageList:e}=n;return e.length>1});G(()=>{n.show&&_(),n.imageList&&w()});const E=e=>{n.maskClosable&&e.target&&e.target.classList.contains(`${i}-content`)&&b(e)},F=()=>o("div",{class:`${i}__close`,onClick:b},[o(P,{class:`${i}__close-icon`},null)]),X=()=>{if(!d(D))return null;const{currentIndex:e}=t,{imageList:l}=n;return o("div",{class:`${i}__index`},[e+1,B(" / "),l.length])},T=()=>o("div",{class:`${i}__controller`},[o("div",{class:`${i}__controller-item`,onClick:()=>h(-v.value)},[o("img",{src:Q},null)]),o("div",{class:`${i}__controller-item`,onClick:()=>h(v.value)},[o("img",{src:J},null)]),o("div",{class:`${i}__controller-item`,onClick:R},[o("img",{src:j},null)]),o("div",{class:`${i}__controller-item`,onClick:()=>p(-90)},[o("img",{src:Z},null)]),o("div",{class:`${i}__controller-item`,onClick:()=>p(90)},[o("img",{src:q},null)])]),O=e=>d(D)?o("div",{class:[`${i}__arrow`,e],onClick:()=>y(e)},[e==="left"?o(z,null,null):o(H,null,null)]):null;return()=>t.show&&o("div",{class:i,ref:f,onMouseup:A,onClick:E},[o("div",{class:`${i}-content`},[o("img",{style:d(Y),class:[`${i}-image`,t.status===c.DONE?"":"hidden"],ref:u,src:t.currentUrl,onMousedown:N},null),F(),X(),T(),O("left"),O("right")])])}});const le=U({name:"UseDraggable",props:["position","handle"],setup(n,{slots:g,emit:I}){const r=S(),t=x(()=>{var _;return(_=n.handle)!=null?_:r.value}),f=n.position?{x:n.position[0],y:n.position[1]}:{x:0,y:0},u=k(K(r,{handle:t,initialValue:f}));return()=>{if(g.default)return V(n.as||"div",{ref:r,style:`touch-action:none;${u.style}`},g.default(u))}}});export{le as U,ne as _};
//# sourceMappingURL=ClickOutSide.vue_vue_type_style_index_0_scoped_edbeaf5e_lang.6182302c.js.map
